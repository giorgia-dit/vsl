02-14 12:53 INFO: ************************* ARGS *************************
02-14 12:53 INFO: Namespace(batch_size=10, cdim=50, char_vocab_size=300, chsize=100, data_file='./input/preprocessed/pproc_l2.evalita', debug=True, edim=100, embed_file='./input/it.bin', embed_type='ud', eval_every=10000, f1_score=False, grad_clip=10.0, klr=0.0001, l2=0.0, lr=0.001, mhsize=100, mlayer=2, model='g', n_iter=30000, opt='adam', prefix=None, print_every=5000, prior_file='./output_2021-02-14-12:53:38/test_g', random_seed=0, rsize=100, rtype='gru', save_prior=True, summarize=True, tag_file='./input/preprocessed/evalita_tagfile', train_emb=False, tw=True, ufl=1, ufu=1, unlabel_batch_size=10, unlabel_file=None, ur=0.5, use_cuda=True, use_unlabel=True, vocab_file='./output_2021-02-14-12:53:38/vocab', vocab_size=100000, xvar=0.001, ysize=25, zsize=50)
02-14 12:53 INFO: ************************* ARGS *************************
02-14 12:53 INFO: ************************* DATA PREPARATION *************************
02-14 12:53 INFO: loading data from ./input/preprocessed/pproc_l2.evalita ...
02-14 12:53 INFO: loading embedding file from ./input/it.bin
02-14 12:53 INFO: loading projection weights from ./input/it.bin
02-14 12:53 DEBUG: {'uri': './input/it.bin', 'mode': 'rb', 'buffering': -1, 'encoding': None, 'errors': None, 'newline': None, 'closefd': True, 'opener': None, 'ignore_ext': False, 'transport_params': None}
02-14 12:53 INFO: loaded (303948, 100) matrix from ./input/it.bin
02-14 12:53 INFO: vocab file not exist, start building
02-14 12:53 INFO: #Chars: 95
02-14 12:53 INFO: ('a', 58832)
02-14 12:53 INFO: ('e', 58654)
02-14 12:53 INFO: ('i', 58114)
02-14 12:53 INFO: ('o', 47167)
02-14 12:53 INFO: ('n', 37768)
02-14 12:53 INFO: ...
02-14 12:53 INFO: ('Ù', 3)
02-14 12:53 INFO: ('À', 3)
02-14 12:53 INFO: ('+', 3)
02-14 12:53 INFO: ('&', 2)
02-14 12:53 INFO: ('Ò', 1)
02-14 12:53 INFO: char vocab size: 96
02-14 12:53 INFO: 18491/18492 words are initialized with loaded embeddings.
02-14 12:53 INFO: saving to ./output_2021-02-14-12:53:38/vocab/vocab_100000
02-14 12:53 INFO: loading tags from ./input/preprocessed/evalita_tagfile
02-14 12:53 INFO: tag vocab size: 32
02-14 12:53 INFO: #sent: 965
02-14 12:53 INFO: #word: 24319
02-14 12:53 INFO: #tag: 24319
02-14 12:53 INFO: #sent: 537
02-14 12:53 INFO: #word: 12803
02-14 12:53 INFO: #tag: 12803
02-14 12:53 INFO: #sent: 670
02-14 12:53 INFO: #word: 17313
02-14 12:53 INFO: #tag: 17313
02-14 12:53 INFO: #train data: 965, max len: 112, min len: 2, avg len: 25.20
02-14 12:53 INFO: #unk in train sentences: (1200, 24319, 0.04934413421604507)
02-14 12:53 INFO: #dev data: 537, max len: 80, min len: 2, avg len: 23.84
02-14 12:53 INFO: #unk in dev sentences: (630, 12803, 0.049207217058501916)
02-14 12:53 INFO: #test data: 670, max len: 145, min len: 1, avg len: 25.84
02-14 12:53 INFO: #unk in test sentences: (800, 17313, 0.04620805175301796)
02-14 12:53 INFO: #sent: 3860
02-14 12:53 INFO: #unlabeled data: 3860, max len: 123, min len: 1, avg len: 25.03
02-14 12:53 INFO: #unk in unlabeled sentences: (4612, 96634, 0.0477264730840077)
02-14 12:53 INFO: labeled buffer size: logvar: 965, mean: 965
02-14 12:53 INFO: unlabeled buffer size: logvar: 3860, mean: 3860
02-14 12:53 INFO: ************************* DATA PREPARATION *************************
02-14 12:53 INFO: ************************* MODEL INITIALIZATION *************************
02-14 12:53 INFO: Initialized with pretrained word embedding
02-14 12:53 INFO: Word Embedding not trainable
02-14 12:53 INFO: transferred model to gpu
02-14 12:53 INFO: vsl_g(
  (char_encoder): char_rnn(
    (char_embed): Embedding(96, 50)
    (char_cell): GRU(50, 100, batch_first=True, bidirectional=True)
  )
  (word_embed): Embedding(18492, 100)
  (word_encoder): GRU(300, 100, batch_first=True, bidirectional=True)
  (x2token): Linear(in_features=100, out_features=18492, bias=False)
  (to_latent_variable): gaussian_layer(
    (q_mean2_mlp): Linear(in_features=200, out_features=50, bias=True)
    (q_logvar2_mlp): Linear(in_features=200, out_features=50, bias=True)
  )
  (classifier): Linear(in_features=50, out_features=32, bias=True)
  (z2x): Sequential(
    (0): Linear(in_features=50, out_features=100, bias=True)
    (1): ReLU()
    (2): Linear(in_features=100, out_features=100, bias=True)
    (3): ReLU()
    (4): Linear(in_features=100, out_features=100, bias=True)
  )
)
02-14 12:53 INFO: ************************* MODEL INITIALIZATION *************************
02-14 12:53 INFO: Training start ...
02-14 13:02 INFO: it: 5000 (max: 97), kl_temp: 0.65, labeled, loss: 1.135, logloss: 0.633, kl_div: 2.816, sup_loss: 0.306, elapsed time: 553.0(s), unlabeled, loss: 1.098, logloss: 0.706, kl_div: 7.016, elapsed time: 553.0(s)
02-14 13:12 INFO: it: 10000 (max: 97), kl_temp: 1.00, labeled, loss: 0.360, logloss: 0.039, kl_div: 0.258, sup_loss: 0.086, elapsed time: 561.2(s), unlabeled, loss: 0.302, logloss: 0.087, kl_div: 0.236, elapsed time: 561.2(s)
02-14 13:12 INFO: ************************* DEV SET EVALUATION *************************
02-14 13:12 INFO: acc: 0.95493, f1: 0.00000, prec: 0.00000, rec: 0.00000, log_loss: 0.097, elapsed time: 1.2(s)
02-14 13:12 INFO: ************************* DEV SET EVALUATION *************************
02-14 13:12 INFO: ************************* TEST SET EVALUATION *************************
02-14 13:12 INFO: acc: 0.95651, f1: 0.00000, prec: 0.00000, rec: 0.00000, log_loss: 0.071, elapsed time: 1.5(s)
02-14 13:12 INFO: ************************* TEST SET EVALUATION *************************
02-14 13:12 INFO: model saved to ./output_2021-02-14-12:53:38/model.ckpt
02-14 13:12 INFO: prior saved to: ./output_2021-02-14-12:53:38/test_g/label_logvar_50
02-14 13:12 INFO: prior saved to: ./output_2021-02-14-12:53:38/test_g/label_mean_50
02-14 13:12 INFO: prior saved to: ./output_2021-02-14-12:53:38/test_g/unlabel_logvar_50
02-14 13:12 INFO: prior saved to: ./output_2021-02-14-12:53:38/test_g/unlabel_mean_50
02-14 13:12 INFO: best dev result: 0.9549, test result: 0.9565, 
02-14 13:21 INFO: it: 15000 (max: 97), kl_temp: 1.00, labeled, loss: 0.286, logloss: 0.028, kl_div: 0.209, sup_loss: 0.049, elapsed time: 561.7(s), unlabeled, loss: 0.245, logloss: 0.059, kl_div: 0.186, elapsed time: 561.7(s)
02-14 13:31 INFO: it: 20000 (max: 97), kl_temp: 1.00, labeled, loss: 0.251, logloss: 0.024, kl_div: 0.199, sup_loss: 0.029, elapsed time: 559.1(s), unlabeled, loss: 0.221, logloss: 0.045, kl_div: 0.176, elapsed time: 559.1(s)
02-14 13:31 INFO: ************************* DEV SET EVALUATION *************************
02-14 13:31 INFO: acc: 0.95954, f1: 0.00000, prec: 0.00000, rec: 0.00000, log_loss: 0.078, elapsed time: 1.2(s)
02-14 13:31 INFO: ************************* DEV SET EVALUATION *************************
02-14 13:31 INFO: ************************* TEST SET EVALUATION *************************
02-14 13:31 INFO: acc: 0.95968, f1: 0.00000, prec: 0.00000, rec: 0.00000, log_loss: 0.061, elapsed time: 1.5(s)
02-14 13:31 INFO: ************************* TEST SET EVALUATION *************************
02-14 13:31 INFO: model saved to ./output_2021-02-14-12:53:38/model.ckpt
02-14 13:31 INFO: prior saved to: ./output_2021-02-14-12:53:38/test_g/label_logvar_50
02-14 13:31 INFO: prior saved to: ./output_2021-02-14-12:53:38/test_g/label_mean_50
02-14 13:31 INFO: prior saved to: ./output_2021-02-14-12:53:38/test_g/unlabel_logvar_50
02-14 13:31 INFO: prior saved to: ./output_2021-02-14-12:53:38/test_g/unlabel_mean_50
02-14 13:31 INFO: best dev result: 0.9595, test result: 0.9597, 
02-14 13:40 INFO: it: 25000 (max: 97), kl_temp: 1.00, labeled, loss: 0.223, logloss: 0.022, kl_div: 0.183, sup_loss: 0.018, elapsed time: 558.7(s), unlabeled, loss: 0.202, logloss: 0.038, kl_div: 0.164, elapsed time: 558.7(s)
02-14 13:49 INFO: it: 30000 (max: 97), kl_temp: 1.00, labeled, loss: 0.208, logloss: 0.021, kl_div: 0.174, sup_loss: 0.012, elapsed time: 558.1(s), unlabeled, loss: 0.191, logloss: 0.034, kl_div: 0.157, elapsed time: 558.1(s)
02-14 13:49 INFO: ************************* DEV SET EVALUATION *************************
02-14 13:49 INFO: acc: 0.96087, f1: 0.00000, prec: 0.00000, rec: 0.00000, log_loss: 0.081, elapsed time: 1.2(s)
02-14 13:49 INFO: ************************* DEV SET EVALUATION *************************
02-14 13:49 INFO: ************************* TEST SET EVALUATION *************************
02-14 13:49 INFO: acc: 0.96020, f1: 0.00000, prec: 0.00000, rec: 0.00000, log_loss: 0.055, elapsed time: 1.5(s)
02-14 13:49 INFO: ************************* TEST SET EVALUATION *************************
02-14 13:49 INFO: model saved to ./output_2021-02-14-12:53:38/model.ckpt
02-14 13:49 INFO: prior saved to: ./output_2021-02-14-12:53:38/test_g/label_logvar_50
02-14 13:49 INFO: prior saved to: ./output_2021-02-14-12:53:38/test_g/label_mean_50
02-14 13:49 INFO: prior saved to: ./output_2021-02-14-12:53:38/test_g/unlabel_logvar_50
02-14 13:49 INFO: prior saved to: ./output_2021-02-14-12:53:38/test_g/unlabel_mean_50
02-14 13:49 INFO: best dev result: 0.9609, test result: 0.9602, 
