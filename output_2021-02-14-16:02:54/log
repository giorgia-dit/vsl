02-14 16:02 INFO: ************************* ARGS *************************
02-14 16:02 INFO: Namespace(batch_size=10, cdim=50, char_vocab_size=300, chsize=100, data_file='./input/preprocessed/it_isdt-ud-pproc_l2_ul8.ud', debug=True, edim=100, embed_file='./input/it.bin', embed_type='ud', eval_every=10000, f1_score=False, grad_clip=10.0, klr=0.0001, l2=0.0, lr=0.001, mhsize=100, mlayer=2, model='hier', n_iter=30000, opt='adam', prefix=None, print_every=5000, prior_file='./output_2021-02-14-16:02:54/test_gg_hier', random_seed=0, rsize=100, rtype='gru', save_prior=True, summarize=True, tag_file='./input/preprocessed/ud_tagfile', train_emb=False, tw=True, ufl=1, ufu=1, unlabel_batch_size=10, unlabel_file=None, ur=0.5, use_cuda=True, use_unlabel=True, vocab_file='./output_2021-02-14-16:02:54/it_isdt-ud-vocab', vocab_size=100000, xvar=0.001, ysize=25, zsize=50)
02-14 16:02 INFO: ************************* ARGS *************************
02-14 16:02 INFO: ************************* DATA PREPARATION *************************
02-14 16:02 INFO: loading data from ./input/preprocessed/it_isdt-ud-pproc_l2_ul8.ud ...
02-14 16:02 INFO: loading embedding file from ./input/it.bin
02-14 16:02 INFO: loading projection weights from ./input/it.bin
02-14 16:02 DEBUG: {'uri': './input/it.bin', 'mode': 'rb', 'buffering': -1, 'encoding': None, 'errors': None, 'newline': None, 'closefd': True, 'opener': None, 'ignore_ext': False, 'transport_params': None}
02-14 16:02 INFO: loaded (303948, 100) matrix from ./input/it.bin
02-14 16:02 INFO: vocab file not exist, start building
02-14 16:02 INFO: #Chars: 124
02-14 16:02 INFO: ('i', 146577)
02-14 16:02 INFO: ('a', 128674)
02-14 16:02 INFO: ('e', 127719)
02-14 16:02 INFO: ('o', 100500)
02-14 16:02 INFO: ('l', 85875)
02-14 16:02 INFO: ...
02-14 16:02 INFO: ('í', 1)
02-14 16:02 INFO: ('ã', 1)
02-14 16:02 INFO: ('Ì', 1)
02-14 16:02 INFO: ('`', 1)
02-14 16:02 INFO: ('線', 1)
02-14 16:02 INFO: char vocab size: 125
02-14 16:02 INFO: 26562/26563 words are initialized with loaded embeddings.
02-14 16:02 INFO: saving to ./output_2021-02-14-16:02:54/it_isdt-ud-vocab/vocab_100000
02-14 16:02 INFO: loading tags from ./input/preprocessed/ud_tagfile
02-14 16:02 INFO: tag vocab size: 18
02-14 16:02 INFO: #sent: 2606
02-14 16:02 INFO: #word: 56263
02-14 16:02 INFO: #tag: 56263
02-14 16:02 INFO: #sent: 564
02-14 16:02 INFO: #word: 12683
02-14 16:02 INFO: #tag: 12683
02-14 16:02 INFO: #sent: 482
02-14 16:02 INFO: #word: 11153
02-14 16:02 INFO: #tag: 11153
02-14 16:02 INFO: #train data: 2606, max len: 78, min len: 1, avg len: 21.59
02-14 16:02 INFO: #unk in train sentences: (1871, 56263, 0.033254536729289234)
02-14 16:02 INFO: #dev data: 564, max len: 84, min len: 4, avg len: 22.49
02-14 16:02 INFO: #unk in dev sentences: (432, 12683, 0.03406134195379642)
02-14 16:02 INFO: #test data: 482, max len: 125, min len: 5, avg len: 23.14
02-14 16:02 INFO: #unk in test sentences: (380, 11153, 0.034071550255536626)
02-14 16:02 INFO: #sent: 10427
02-14 16:02 INFO: #unlabeled data: 10427, max len: 80, min len: 1, avg len: 21.97
02-14 16:02 INFO: #unk in unlabeled sentences: (7949, 229056, 0.034703303995529476)
02-14 16:02 INFO: labeled buffer size: logvar1: 2606, mean1: 2606, logvar2: 2606, mean2: 2606
02-14 16:02 INFO: unlabeled buffer size: logvar1: 10427, mean1: 10427, logvar2: 10427, mean2: 10427
02-14 16:02 INFO: ************************* DATA PREPARATION *************************
02-14 16:02 INFO: ************************* MODEL INITIALIZATION *************************
02-14 16:02 INFO: Initialized with pretrained word embedding
02-14 16:02 INFO: Word Embedding not trainable
02-14 16:03 INFO: transferred model to gpu
02-14 16:03 INFO: vsl_gg(
  (char_encoder): char_rnn(
    (char_embed): Embedding(125, 50)
    (char_cell): GRU(50, 100, batch_first=True, bidirectional=True)
  )
  (word_embed): Embedding(26563, 100)
  (word_encoder): GRU(300, 100, batch_first=True, bidirectional=True)
  (x2token): Linear(in_features=100, out_features=26563, bias=False)
  (to_latent_variable): gaussian_hier_layer(
    (q_mean2_mlp): Linear(in_features=200, out_features=25, bias=True)
    (q_logvar2_mlp): Linear(in_features=200, out_features=25, bias=True)
    (q_mean_mlp): Linear(in_features=225, out_features=50, bias=True)
    (q_logvar_mlp): Linear(in_features=225, out_features=50, bias=True)
  )
  (classifier): Linear(in_features=25, out_features=18, bias=True)
  (yz2x): Sequential(
    (0): Linear(in_features=50, out_features=100, bias=True)
    (1): ReLU()
    (2): Linear(in_features=100, out_features=100, bias=True)
    (3): ReLU()
    (4): Linear(in_features=100, out_features=100, bias=True)
  )
)
02-14 16:03 INFO: ************************* MODEL INITIALIZATION *************************
02-14 16:03 INFO: Training start ...
02-14 16:12 INFO: it: 5000 (max: 261), kl_temp: 0.65, labeled, loss: 1.435, logloss: 0.842, kl_div: 5.594, sup_loss: 0.282, elapsed time: 553.9(s), unlabeled, loss: 2.111, logloss: 0.892, kl_div: 13.379, elapsed time: 553.9(s)
02-14 16:21 INFO: it: 10000 (max: 261), kl_temp: 1.00, labeled, loss: 0.394, logloss: 0.099, kl_div: 0.205, sup_loss: 0.108, elapsed time: 568.4(s), unlabeled, loss: 0.364, logloss: 0.157, kl_div: 0.229, elapsed time: 568.4(s)
02-14 16:21 INFO: ************************* DEV SET EVALUATION *************************
02-14 16:21 INFO: acc: 0.96610, f1: 0.00000, prec: 0.00000, rec: 0.00000, log_loss: 0.062, elapsed time: 1.2(s)
02-14 16:21 INFO: ************************* DEV SET EVALUATION *************************
02-14 16:21 INFO: ************************* TEST SET EVALUATION *************************
02-14 16:21 INFO: acc: 0.96960, f1: 0.00000, prec: 0.00000, rec: 0.00000, log_loss: 0.056, elapsed time: 1.1(s)
02-14 16:21 INFO: ************************* TEST SET EVALUATION *************************
02-14 16:21 INFO: model saved to ./output_2021-02-14-16:02:54/model.ckpt
02-14 16:21 INFO: prior saved to: ./output_2021-02-14-16:02:54/test_gg_hier/label_logvar1_50
02-14 16:21 INFO: prior saved to: ./output_2021-02-14-16:02:54/test_gg_hier/label_mean1_50
02-14 16:21 INFO: prior saved to: ./output_2021-02-14-16:02:54/test_gg_hier/label_logvar2_25
02-14 16:21 INFO: prior saved to: ./output_2021-02-14-16:02:54/test_gg_hier/label_mean2_25
02-14 16:21 INFO: prior saved to: ./output_2021-02-14-16:02:54/test_gg_hier/unlabel_logvar1_50
02-14 16:21 INFO: prior saved to: ./output_2021-02-14-16:02:54/test_gg_hier/unlabel_mean1_50
02-14 16:21 INFO: prior saved to: ./output_2021-02-14-16:02:54/test_gg_hier/unlabel_logvar2_25
02-14 16:21 INFO: prior saved to: ./output_2021-02-14-16:02:54/test_gg_hier/unlabel_mean2_25
02-14 16:21 INFO: best dev result: 0.9661, test result: 0.9696, 
02-14 16:31 INFO: it: 15000 (max: 261), kl_temp: 1.00, labeled, loss: 0.299, logloss: 0.055, kl_div: 0.171, sup_loss: 0.073, elapsed time: 569.5(s), unlabeled, loss: 0.280, logloss: 0.106, kl_div: 0.174, elapsed time: 569.5(s)
02-14 16:40 INFO: it: 20000 (max: 261), kl_temp: 1.00, labeled, loss: 0.252, logloss: 0.036, kl_div: 0.164, sup_loss: 0.051, elapsed time: 559.9(s), unlabeled, loss: 0.244, logloss: 0.079, kl_div: 0.165, elapsed time: 559.9(s)
02-14 16:40 INFO: ************************* DEV SET EVALUATION *************************
02-14 16:40 INFO: acc: 0.96870, f1: 0.00000, prec: 0.00000, rec: 0.00000, log_loss: 0.041, elapsed time: 1.2(s)
02-14 16:40 INFO: ************************* DEV SET EVALUATION *************************
02-14 16:40 INFO: ************************* TEST SET EVALUATION *************************
02-14 16:40 INFO: acc: 0.97014, f1: 0.00000, prec: 0.00000, rec: 0.00000, log_loss: 0.044, elapsed time: 1.1(s)
02-14 16:40 INFO: ************************* TEST SET EVALUATION *************************
02-14 16:40 INFO: model saved to ./output_2021-02-14-16:02:54/model.ckpt
02-14 16:40 INFO: prior saved to: ./output_2021-02-14-16:02:54/test_gg_hier/label_logvar1_50
02-14 16:40 INFO: prior saved to: ./output_2021-02-14-16:02:54/test_gg_hier/label_mean1_50
02-14 16:40 INFO: prior saved to: ./output_2021-02-14-16:02:54/test_gg_hier/label_logvar2_25
02-14 16:40 INFO: prior saved to: ./output_2021-02-14-16:02:54/test_gg_hier/label_mean2_25
02-14 16:40 INFO: prior saved to: ./output_2021-02-14-16:02:54/test_gg_hier/unlabel_logvar1_50
02-14 16:40 INFO: prior saved to: ./output_2021-02-14-16:02:54/test_gg_hier/unlabel_mean1_50
02-14 16:40 INFO: prior saved to: ./output_2021-02-14-16:02:54/test_gg_hier/unlabel_logvar2_25
02-14 16:40 INFO: prior saved to: ./output_2021-02-14-16:02:54/test_gg_hier/unlabel_mean2_25
02-14 16:40 INFO: best dev result: 0.9687, test result: 0.9701, 
02-14 16:49 INFO: it: 25000 (max: 261), kl_temp: 1.00, labeled, loss: 0.229, logloss: 0.029, kl_div: 0.163, sup_loss: 0.037, elapsed time: 548.7(s), unlabeled, loss: 0.226, logloss: 0.065, kl_div: 0.162, elapsed time: 548.7(s)
02-14 16:59 INFO: it: 30000 (max: 261), kl_temp: 1.00, labeled, loss: 0.211, logloss: 0.023, kl_div: 0.160, sup_loss: 0.027, elapsed time: 562.5(s), unlabeled, loss: 0.213, logloss: 0.054, kl_div: 0.158, elapsed time: 562.5(s)
02-14 16:59 INFO: ************************* DEV SET EVALUATION *************************
02-14 16:59 INFO: acc: 0.96925, f1: 0.00000, prec: 0.00000, rec: 0.00000, log_loss: 0.035, elapsed time: 1.2(s)
02-14 16:59 INFO: ************************* DEV SET EVALUATION *************************
02-14 16:59 INFO: ************************* TEST SET EVALUATION *************************
02-14 16:59 INFO: acc: 0.97086, f1: 0.00000, prec: 0.00000, rec: 0.00000, log_loss: 0.033, elapsed time: 1.1(s)
02-14 16:59 INFO: ************************* TEST SET EVALUATION *************************
02-14 16:59 INFO: model saved to ./output_2021-02-14-16:02:54/model.ckpt
02-14 16:59 INFO: prior saved to: ./output_2021-02-14-16:02:54/test_gg_hier/label_logvar1_50
02-14 16:59 INFO: prior saved to: ./output_2021-02-14-16:02:54/test_gg_hier/label_mean1_50
02-14 16:59 INFO: prior saved to: ./output_2021-02-14-16:02:54/test_gg_hier/label_logvar2_25
02-14 16:59 INFO: prior saved to: ./output_2021-02-14-16:02:54/test_gg_hier/label_mean2_25
02-14 16:59 INFO: prior saved to: ./output_2021-02-14-16:02:54/test_gg_hier/unlabel_logvar1_50
02-14 16:59 INFO: prior saved to: ./output_2021-02-14-16:02:54/test_gg_hier/unlabel_mean1_50
02-14 16:59 INFO: prior saved to: ./output_2021-02-14-16:02:54/test_gg_hier/unlabel_logvar2_25
02-14 16:59 INFO: prior saved to: ./output_2021-02-14-16:02:54/test_gg_hier/unlabel_mean2_25
02-14 16:59 INFO: best dev result: 0.9693, test result: 0.9709, 
